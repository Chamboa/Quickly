///////// TABLAS

CREATE TABLE Asistencia (
    UUID_asistencia Varchar2 (50) PRIMARY KEY,
    hora_de_entrada NUMBER NOT NULL,
    hora_de_salida NUMBER NOT NULL,
    asistencia_total INT NOT NULL.
    UUID_Evento Varchar2 (50) Not null,
    FOREIGN KEY (UUID_Evento) REFERENCES Eventos (UUID),
);

SELECT * FROM Asistencia;

INSERT INTO Asistencia (UUID_asistencia, hora_de_entrada, hora_de_salida, asistencia_total, UUID_Evento) 
VALUES (1, 4.30, 5.40, 1, 1);
INSERT INTO Asistencia (UUID_asistencia, hora_de_entrada, hora_de_salida, asistencia_total, UUID_Evento) 
VALUES (2, 3.40, 5.50, 1, 2);


CREATE TABLE Eventos (
    UUID Varchar2 (50) PRIMARY KEY,
    UUID_Usuario Varchar2 (50) NOT NULL,
    lugar VARCHAR2 (100) NOT NULL,
    descripcion VARCHAR2 (100) NOT NULL,
    nombre VARCHAR2 (30) NOT NULL,
    fecha Varchar2 (50) NOT NULL,
    hora Varchar2 (50) NOT NULL,
    FOREIGN KEY (UUID) REFERENCES Usuario (UUID)
);

SELECT * FROM Eventos;

INSERT INTO Eventos (UUID, UUID_Usuario, lugar, descripcion, nombre, fecha, hora) 
VALUES (1, 1, 'Auditorio', 'Conferencia sobre educación', 'Conferencia Educativa', TO_DATE('2024-07-01', 'YYYY-MM-DD'), TO_DATE('12:00', 'HH24:MI'));
INSERT INTO Eventos (UUID, UUID_Usuario, lugar, descripcion, nombre, fecha, hora) 
VALUES (2, 2, 'Cancha de deportes', 'Torneo de fútbol intergrados', 'Torneo de Fútbol', TO_DATE('2024-07-05', 'YYYY-MM-DD'), TO_DATE('14:00', 'HH24:MI'));




CREATE TABLE Usuario (
    UUID Varchar2 (50) PRIMARY KEY,
    nombre VARCHAR2 (100) NOT NULL,
    id_grado INT NOT NULL,
    id_rol INT NOT NULL,
    id_comite INT NOT NULL,
    contraseña VARCHAR2 (30) NOT NULL,
    correo_electronico VARCHAR2 (100) NOT NULL,
    FOREIGN KEY (id_grado) REFERENCES Grado (id_grado),
    FOREIGN KEY (id_rol) REFERENCES Rol (id_rol),
    FOREIGN KEY (id_comite) REFERENCES Comite (id_comite)
);

SELECT * FROM Usuario;

INSERT INTO Usuario (UUID, nombre, id_grado, id_rol, id_comite, contraseña, correo_electronico) 
VALUES (1, 'Juan Pérez', 1, 1, 1, '123', 'juan.perez@ricaldone.edu.sv');
INSERT INTO Usuario (UUID, nombre, id_grado, id_rol, id_comite, contraseña, correo_electronico) 
VALUES (2, 'María López', 2, 1, 2, '123', 'maria.lopez@ricaldone.edu.sv');


CREATE TABLE Grado (
    id_grado INT PRIMARY KEY,
    grado VARCHAR2(50) NOT NULL
);

SELECT * FROM Grado;

INSERT INTO Grado (id_grado, grado) VALUES (1, 'Primer año');
INSERT INTO Grado (id_grado, grado) VALUES (2, 'Segundo año');

CREATE TABLE Rol (
    id_rol INT PRIMARY KEY,
    tipo_rol VARCHAR2(50) NOT NULL
);

SELECT * FROM Rol

INSERT INTO Rol (id_rol, tipo_rol) VALUES (1, 'Estudiante');
INSERT INTO Rol (id_rol, tipo_rol) VALUES (2, 'Coordinador');
INSERT INTO Rol (id_rol, tipo_rol) VALUES (3, 'Administrador');





CREATE TABLE Comite (
    id_comite INT PRIMARY KEY,
    comite VARCHAR2(100) NOT NULL, 
    descripcion VARCHAR2 (300) NOT NULL,
    cupos INT NOT NULL
);

SELECT * FROM Comite;

INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (1, 'Seguridad y emergencia', 'Encargado de la seguridad del instituto, primeros auxilios y control en situaciones de riesgo', 10);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (2, 'Deportivo', 'Organizadores de los eventos deportivos del instituto', 8);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (3, 'Logistica', 'Organizadores de los eventos deportivos del instituto', 35);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (4, 'Comunicaciones', 'Organizadores de los eventos deportivos del instituto', 23);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (5, 'Social y protocolo', 'Organizadores de los eventos deportivos del instituto', 10);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (6, 'Tecnico Cientifico', 'Organizadores de los eventos deportivos del instituto', 35);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (7, 'Medio Ambiente', 'Organizadores de los eventos deportivos del instituto', 22);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (8, 'Vida Comunitaria', 'Organizadores de los eventos deportivos del instituto', 20);
INSERT INTO Comite (id_comite, comite, descripcion, cupos) VALUES (9, 'Cultural', 'Organizadores de los eventos deportivos del instituto', 15);


CREATE TABLE Reclamo (
    id_mensaje INT PRIMARY KEY,
    UUID INT NOT NULL,
    mensaje VARCHAR2 (300) NOT NULL,
    FOREIGN KEY (UUID) REFERENCES Usuario (UUID)
); 

SELECT * FROM Reclamo;

INSERT INTO Reclamo (id_mensaje, UUID, mensaje) 
VALUES (1, 1, 'Tengo un problema con mis horas, no me las han contado');
INSERT INTO Reclamo (id_mensaje, UUID, mensaje) 
VALUES (2, 2, 'Falta de coordinacion en mis horas sociales');





SELECT 
    u.nombre AS Usuario,
    g.grado AS Grado,
    r.tipo_rol AS Rol,
    c.comite AS Comite,
    e.nombre AS Evento,
    e.descripcion AS DescripcionEvento,
    e.fecha AS FechaEvento,
    e.hora AS HoraEvento,
    a.hora_de_entrada AS HoraEntrada,
    a.hora_de_salida AS HoraSalida,
    a.asistencia_total AS AsistenciaTotal

FROM 
    Usuario u
    LEFT JOIN Grado g ON u.id_grado = g.id_grado
    LEFT JOIN Rol r ON u.id_rol = r.id_rol
    LEFT JOIN Comite c ON u.id_comite = c.id_comite
    LEFT JOIN Eventos e ON u.UUID_Usuario = e.UUID_Usuario
    LEFT JOIN Asistencia a ON u.UUID_Asistencia = a.UUID_Asistencia;
